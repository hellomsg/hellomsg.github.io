---
title: B-树（Balance Tree）
description: "B-树主要用于文件系统以及部分数据库索引"
---

### B-树有什么用？  
B-树主要用于文件系统以及部分数据库索引，比如MongoDB。

### 由二叉查找树到B-树
从算法逻辑上来讲，二叉查找树的查找速度和比较次数都是最小的，但是为什么索引没有用二叉查找树来实现呢？因为磁盘IO！数据库索引是存储在磁盘上的，当数据量比较大的时候，索引也会很大。当我们利用索引查询的时候，能把整个索引全部加载到内存吗？显然不可能。能做到的只有逐一加载每一个磁盘页，这里的磁盘页对应着索引树的节点。最坏情况下，磁盘IO次数等于索引树的高度。为了减少磁盘IO次数，需要把原本“瘦高”的树结构变得“矮胖”。

### 他有的特征？  
B-树是一种多路平衡查找树，他的每个节点最多包含k个孩子，k被称为B-树的阶。k的大小取决于磁盘页的大小。
一个m阶的B树具有如下特征： 
 
1. 根结点至少有两个子女
2. 每个中间节点都包含k-1个元素和k个孩子，其中m/2<=k<=m
3. 每个叶子结点都包含k-1个元素，其中m/2<=k<=m
4. 所有的叶子结点都位于同一层
5. 每个节点中的元素从小到大排列，节点中k-1个元素正好是k个孩子包含的元素的值域划分。

### 优势
B-树在查询中的比较次数其实不比二叉查找树少，尤其当单一节点中的元素数量很多时，可是相比磁盘IO的速度，内存中的比较耗时几乎可以忽略。所以只要树的高度足够低，IO次数足够少，就可以提升查找性能。相比之下节点内部元素多一些也没有关系，仅仅是多了几次内存交互，只要不超过磁盘页的大小即可。这就是**B-树的优势**之一。
